<div class="backdrop" id="backdrop" (click)="onClose()"></div>
<dialog open id="dialogBox" class="dialog-box">
  <div class="popup-overlay">
    <div class="popup-content">
      <div class="popup-header">
        <h2>Change Password</h2>
        <button class="close-btn" (click)="onClose()">&times;</button>
      </div>

      <form [formGroup]="passwordForm" (ngSubmit)="onSubmit()">
        <div class="form-group">
          <label for="currentPassword">Current Password</label>
          <input
            type="password"
            id="currentPassword"
            class="form-control"
            formControlName="currentPassword">
          <div class="error-message" *ngIf="passwordForm.get('currentPassword')?.touched &&
                 passwordForm.get('currentPassword')?.errors?.['required']">
            Current password is required
          </div>
        </div>

        <div class="form-group">
          <label for="newPassword">New Password</label>
          <input
            type="password"
            id="newPassword"
            class="form-control"
            formControlName="newPassword">
          <div class="requirements">
            Password must be at least 8 characters long with 1 uppercase letter,
            1 number, and 1 special character
          </div>
          <div class="error-message" *ngIf="passwordForm.get('newPassword')?.touched &&
                 passwordForm.get('newPassword')?.errors?.['pattern']">
            Password doesn't meet requirements
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm New Password</label>
          <input
            type="password"
            id="confirmPassword"
            class="form-control"
            formControlName="confirmPassword">
          <div class="error-message" *ngIf="passwordForm.get('confirmPassword')?.touched &&
                 passwordForm.errors?.['passwordMismatch']">
            Passwords don't match
          </div>
        </div>

        <div class="button-group">
          <button type="button" class="btn btn-secondary" (click)="onClose()">Cancel</button>
          <button type="submit" class="btn btn-primary" [disabled]="!passwordForm.valid">
            Change Password
          </button>
        </div>
      </form>
    </div>
  </div>
</dialog>
